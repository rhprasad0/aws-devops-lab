apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

namespace: guestbook

resources:
  - serviceaccount.yaml
  - deployment.yaml
  - service.yaml
  - ingress.yaml

# ECR image configuration
images:
  - name: GUESTBOOK_IMAGE
    newName: 407645373626.dkr.ecr.us-east-1.amazonaws.com/eks-lab/guestbook
    newTag: latest

# ConfigMap with actual AWS resource names from Terraform
configMapGenerator:
  - name: guestbook-config
    literals:
      - AWS_REGION=us-east-1
      - DYNAMODB_TABLE_NAME=a2a-guestbook-messages
      - API_KEYS_SECRET_NAME=a2a-guestbook/api-keys
      - RATE_LIMIT_PER_MINUTE=10
      - LOG_LEVEL=INFO
      - PORT=8000

# Common labels
commonLabels:
  app.kubernetes.io/name: guestbook
  app.kubernetes.io/component: application
  app.kubernetes.io/part-of: eks-lab
